<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="/static/img/favicon.ico" /><title>Intalling Perl DBD::Oracle on RHL - Lee Lindley Scratchpad</title><meta name="author" content="Lee Lindley" /><meta name="description" content="Intalling Perl DBD::Oracle on RHL" /><meta name="keywords" content="Intalling Perl DBD::Oracle on RHL, Lee Lindley Scratchpad, oracle, perl, linux" /><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"><meta content="" property="fb:app_id"><meta content="Lee Lindley Scratchpad" property="og:site_name"><meta content="Intalling Perl DBD::Oracle on RHL" property="og:title"><meta content="article" property="og:type"><meta content="Posts on Technical Subjects, mostly Oracle and Linux" property="og:description"><meta content="https://lee-lindley.github.io/oracle/perl/linux/2022/04/28/Perl-DBD-Oracle-RHL.html" property="og:url"><meta content="2022-04-28T12:30:00-04:00" property="article:published_time"><meta content="https://lee-lindley.github.io/about/" property="article:author"><meta content="oracle" property="article:section"><meta content="oracle" property="article:tag"><meta content="perl" property="article:tag"><meta content="installation" property="article:tag"><meta content="linux" property="article:tag"><meta content="DBI" property="article:tag"><meta content="DBD" property="article:tag"><meta content="RHL" property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@"><meta name="twitter:creator" content="@"><meta name="twitter:title" content="Intalling Perl DBD::Oracle on RHL"><meta name="twitter:url" content="https://lee-lindley.github.io/oracle/perl/linux/2022/04/28/Perl-DBD-Oracle-RHL.html"><meta name="twitter:description" content="Posts on Technical Subjects, mostly Oracle and Linux"><link href="/static/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><link rel="stylesheet" href="/static/css/syntax.css"><link href="/static/css/bootstrap.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/static/css/super-search.css"><link rel="stylesheet" href="/static/css/thickbox.css"><link rel="stylesheet" href="/static/css/projects.css"><link rel="stylesheet" href="/static/css/main.css"><body><div class="container"><div class="col-sm-3"><div class="fixed-condition"><h1 class="author-name"><a href="/">Lee Lindley</a></h1><div class="profile-about"> I'm Just Another Perl Hacker who wound up in a big Oracle Database playground</div><div class="social"><ul><li><a href="https://linkedin.com/in/lee-lindley" target="_blank"><i class="fa fa-linkedin"></i></a><li><a href="https://github.com/lee-lindley" target="_blank"><i class="fa fa-github"></i></a></ul></div><div class="search" id="js-search"> <input type="text" placeholder="(sitemap)~$ type to search" class="search__input form-control" id="js-search__input"><ul class="search__results" id="js-search__results"></ul></div><hr /><ul class="sidebar-nav"> <strong>Navigation</strong><li><a href="/">Home</a><li><a class="about" href="/about/">About Me</a><li><a class="about" href="/projects/">My Projects</a><li><a class="about" href="/feed.xml">XML Feed</a></ul></div></div><div class="col-sm-8 col-offset-1 main-layout"><header class="post-header"><h1 class="post-title">Intalling Perl DBD::Oracle on RHL</h1></header><span class="time">28 Apr 2022</span> <span class="categories"> &raquo; <a href="/category/oracle">oracle</a>, <a href="/category/perl">perl</a>, <a href="/category/linux">linux</a> </span><div class="content"><div class="post"><h1 id="introduction">Introduction</h1><p>Over the years I’ve had many opportunities to struggle with compiling <em>Perl</em> and <em>DBD::Oracle</em> on many different flavors of Unix. It was never easy.<p>When package management (yum, etc..) became a thing and I eagerly started looking at it, reality slapped me back down. Nobody was packaging <em>DBD::Oracle</em> and the reason seemed to be the Oracle client library license requirements.<p>When I went looking to do it all again on my home Linux instances, I was pleasantly surprised to find <em>DBD::Oracle</em> was already included on my <strong>Oracle Linux Server release 7.9</strong> server. Oracle apparently doesn’t have an issue getting a distribution license for their own dogfood and were able to include <em>DBD::Oracle</em>. Nice!<p>I also have a <strong>Red Hat Enterprise Linux release 8.5 (Ootpa)</strong> server running under Microsoft <em>Hyper-V</em>. In spite of the close business relationship Oracle has with Red Hat, RHL does not have <em>DBD::Oracle</em> installed, nor was it found in a <em>dnf</em> search. Note that I’ve already installed Oracle Database on this puppy, so I’ve added Oracle repositories. If there is a yum repository out there that contains DBD::Oracle for Linux, I haven’t found it.<p>So here we go again.<p>I know before I start that I need my shell environment to be set so that I can connect with sqlplus. My database SID is <strong>rhl1db</strong> which is a container database. This works for me given how I installed Oracle:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">ORACLE_HOSTNAME</span><span class="o">=</span><span class="si">$(</span><span class="nb">hostname</span><span class="si">)</span>
<span class="nb">export </span><span class="nv">ORAENV_ASK</span><span class="o">=</span>NO
<span class="nb">export </span><span class="nv">ORACLE_SID</span><span class="o">=</span>rhl1db
<span class="nb">.</span> oraenv <span class="nt">-s</span>
</code></pre></div></div><p>From the README for DBD::Oracle I know I need to set a variable <strong>ORACLE_USERID</strong> with the connection string. I could include the @pdbname part there I think, but I also know I can use <strong>TWO_TASK</strong> to specify the PDB. Remember my SID is for the Container DB. I’m going to connect to a PDB named <strong>rhl1pdb</strong>.<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">TWO_TASK</span><span class="o">=</span>rhl1pdb
<span class="nb">export </span><span class="nv">ORACLE_USERID</span><span class="o">=</span>lee/MYPASSWORD
sqlplus <span class="nv">$ORACLE_USERID</span>
<span class="c"># BINGO! I'm in</span>
</code></pre></div></div><p>At this point I’ve taken care of prerequisites in my environment for doing the make. We could download it and run the steps outlined in the README, but I thought I would swing for the fence.<h1 id="trying-cpan">Trying CPAN</h1><p>First, I tried to run a cpan shell.<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>perl <span class="nt">-MCPAN</span> <span class="nt">-e</span> shell
</code></pre></div></div><p>Yeah, we could be so lucky. It wasn’t there, but ahoy! There is a yum package for it.<p>I’m running as root. I realize we are supposed to use <em>sudo</em>. You do you, and leave the old dinosaur alone.<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dnf search perl-CPAN
<span class="c"># bingo</span>
dnf <span class="nb">install </span>perl-CPAN
perl <span class="nt">-MCPAN</span> <span class="nt">-e</span> shell
</code></pre></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Terminal does not support AddHistory.

cpan shell -- CPAN exploration and modules installation (v2.18)
Enter 'h' for help.

cpan[1]&gt; install DBD::Oracle
Reading '/root/.local/share/.cpan/Metadata'
    Database was generated on Thu, 28 Apr 2022 07:29:03 GMT
Running install for module 'DBD::Oracle'
...
</code></pre></div></div><p>My first attempt the make failed for missing library <em>aio</em>. A little google search and we find we need to install <em>libaio-devel</em><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dnf <span class="nb">install </span>libaio-devel
perl <span class="nt">-MCPAN</span> <span class="nt">-e</span> shell
cpan[1]&gt; <span class="nb">install </span>DBD::Oracle
...
</code></pre></div></div><p>This time it compiles, but I run into trouble in the tests. It wants <em>Test::More</em> and <em>Devel::Peek</em>. OK, I’ll try to get those.<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>perl <span class="nt">-MCPAN</span> <span class="nt">-e</span> shell
<span class="nb">install </span>Test::More
<span class="c"># that worked</span>
<span class="nb">install </span>Devel::Peek
<span class="c"># no dice</span>
</code></pre></div></div><p><em>Devel::Peek</em> is tied up somehow. I didn’t try to figure it out. I know that not all tests will pass anyway. How would you know that? You wouldn’t. It is the source of endless frustration for people new to this. But if you google install issues for DBD::Oracle you will see the blase response to just ignore the failed tests (when there are only a few non-critical failures!) and run make install anyway.<p>This time when I ran the install from CPAN shell it completed the majority of the tests and I honestly don’t care about the failures.<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Scanning cache /root/.local/share/.cpan/build for sizes
...
Files=41, Tests=1867, 17 wallclock secs ( 0.27 usr  0.05 sys +  3.86 cusr  0.68 csys =  4.86 CPU)
Result: FAIL
Failed 5/41 test programs. 2/1867 subtests failed.
make: *** [Makefile:1105: test_dynamic] Error 2
  ZARQUON/DBD-Oracle-1.83.tar.gz
  /usr/bin/make test -- NOT OK
//hint// to see the cpan-testers results for installing this module, try:
  reports ZARQUON/DBD-Oracle-1.83.tar.gz
Failed during this command:
 ZARQUON/DBD-Oracle-1.83.tar.gz               : make_test NO

cpan[2]&gt;
</code></pre></div></div><p>We are left with it not installed though. Bummer. Maybe there is a way to tell the CPAN shell to install even after a failed test, but I didn’t bother. At the top of the block above note that it tells me it is doing this make in a cache directory “/root/.local/share/.cpan/build”. I go down that path and find “DBD-Oracle-1.83-0”. In that directory is the Makefile that was created for this build. I do<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make <span class="nb">install</span>
</code></pre></div></div><p>All done.<h1 id="testing-dbdoracle">Testing DBD::Oracle</h1><p>My test script (sans my database password and notice I’m not root anymore):<div class="language-perl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/env perl</span>
<span class="k">use</span> <span class="nv">DBI</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">DBD::</span><span class="nv">Oracle</span><span class="p">;</span>
<span class="k">use</span> <span class="nv">strict</span><span class="p">;</span>
<span class="k">use</span> <span class="nv">warnings</span><span class="p">;</span>

<span class="k">my</span> <span class="nv">$dbh</span> <span class="o">=</span> <span class="nv">DBI</span><span class="o">-&gt;</span><span class="nb">connect</span><span class="p">('</span><span class="s1">dbi:Oracle:</span><span class="p">',</span> <span class="p">'</span><span class="s1">lee@rhl1pdb</span><span class="p">',</span> <span class="p">'</span><span class="s1">my secret password</span><span class="p">'</span>
                        <span class="p">,</span> <span class="p">{</span><span class="s">RaiseError</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="s">AutoCommit</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s">RowCacheSize</span> <span class="o">=&gt;</span> <span class="o">-</span><span class="mi">102400</span><span class="p">,</span> <span class="s">ora_module_name</span> <span class="o">=&gt;</span> <span class="p">'</span><span class="s1">Perl</span><span class="p">'</span> <span class="p">}</span>
                      <span class="p">)</span> <span class="ow">or</span> <span class="nb">die</span> <span class="p">"</span><span class="s2">Database connection not made: DBI::errstr</span><span class="p">";</span>
<span class="nv">$dbh</span><span class="o">-&gt;</span><span class="k">do</span><span class="p">("</span><span class="s2">alter session set nls_date_format = 'mm/dd/yyyy'</span><span class="p">");</span>
<span class="k">print</span> <span class="nv">$dbh</span><span class="o">-&gt;</span><span class="nv">selectrow_array</span><span class="p">("</span><span class="s2">SELECT sysdate from dual</span><span class="p">"),</span> <span class="p">"</span><span class="se">\n</span><span class="p">";</span>
<span class="nv">$dbh</span><span class="o">-&gt;</span><span class="nv">disconnect</span><span class="p">;</span>
</code></pre></div></div><p>And the output:<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lee@rhl1 [/home/lee/git/perl_oracle]
$ ./test_dbd_oracle.pl 
04/28/2022
</code></pre></div></div><p>That may have been the easiest install of <em>DBD::Oracle</em> I’ve ever done.<p>Granted, I had already installed the Oracle database on this server, configured it, and configured connections (listener, TNS, etc…). I had all that working before I started. If you are on a new machine you must first install the Oracle client and get that all working. That’s also easier than it used to be, but no picnic.<p>Hope this helped.</div></div><div class="panel-body"><h4>Related Posts</h4><ul><li class="relatedPost"> <a href="https://lee-lindley.github.io/oracle/plsql/sql/vim/2022/04/29/vim-plsql-syntax.html">Syntax Highlighting for PL/SQL in vim</a> (Categories: <a href="/category/oracle">oracle</a>, <a href="/category/plsql">plsql</a>, <a href="/category/sql">sql</a>, <a href="/category/vim">vim</a>)<li class="relatedPost"> <a href="https://lee-lindley.github.io/oracle/sql/plsql/2022/04/10/hierarchical-profiler-context-switch.html">Profiling PL/SQL to Examine Context Switch Penalty</a> (Categories: <a href="/category/oracle">oracle</a>, <a href="/category/sql">sql</a>, <a href="/category/plsql">plsql</a>)<li class="relatedPost"> <a href="https://lee-lindley.github.io/oracle/sql/plsql/2022/04/10/Regexp_instr-Beginning-of-line-anchor.html">Oracle REGEXP_INSTR and Beginning of Line Anchor</a> (Categories: <a href="/category/oracle">oracle</a>, <a href="/category/sql">sql</a>, <a href="/category/plsql">plsql</a>)<li class="relatedPost"> <a href="https://lee-lindley.github.io/oracle/sql/plsql/2022/04/02/Object-Methods-in-SQL.html">Cost of UDT Object Methods in SQL</a> (Categories: <a href="/category/oracle">oracle</a>, <a href="/category/sql">sql</a>, <a href="/category/plsql">plsql</a>)<li class="relatedPost"> <a href="https://lee-lindley.github.io/plsql/sql/oracle/2022/03/28/Devops-Oracle-Deploy.html">Devops Data Deployment for Oracle</a> (Categories: <a href="/category/plsql">plsql</a>, <a href="/category/sql">sql</a>, <a href="/category/oracle">oracle</a>)<li class="relatedPost"> <a href="https://lee-lindley.github.io/oracle/sql/2022/03/06/Staging_Tables_vs_With.html">Staging Tables vs Single SQL</a> (Categories: <a href="/category/oracle">oracle</a>, <a href="/category/sql">sql</a>)</ul></div><div class="PageNavigation"> <a class="prev" href="/oracle/sql/plsql/2022/04/10/hierarchical-profiler-context-switch.html">&laquo; Profiling PL/SQL to Examine Context Switch Penalty</a> <a class="next" href="/oracle/plsql/sql/vim/2022/04/29/vim-plsql-syntax.html">Syntax Highlighting for PL/SQL in vim &raquo;</a></div><div class="disqus-comments"><div id="disqus_thread"></div><script type="text/javascript"> /* <![CDATA[ */ var disqus_shortname = "leelindleyscratchpad"; var disqus_identifier = "https://lee-lindley.github.io_Intalling Perl DBD::Oracle on RHL"; var disqus_title = "Intalling Perl DBD::Oracle on RHL"; /* * * DON'T EDIT BELOW THIS LINE * * */ (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); /* ]]> */ </script></div><footer> &copy; Lee Lindley - <a href="https://github.com/lee-lindley">https://github.com/lee-lindley</a> - Powered by Jekyll.<div class="btn-github" style="float:right;"> <iframe src="https://ghbtns.com/github-btn.html?user=agusmakmun&repo=agusmakmun.github.io&type=star&count=true" frameborder="0" scrolling="0" width="100" height="20px"></iframe> <iframe src="https://ghbtns.com/github-btn.html?user=agusmakmun&repo=agusmakmun.github.io&type=fork&count=true" frameborder="0" scrolling="0" width="100" height="20px"></iframe></div></footer></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> <script src="/static/js/bootstrap.min.js"></script> <script src="/static/js/super-search.js"></script> <script src="/static/js/thickbox-compressed.js"></script> <script src="/static/js/projects.js"></script>
